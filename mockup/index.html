<!doctype html>
<html>

<head>

  <title>294</title>

  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">

  <script src="./bower_components/webcomponentsjs/webcomponents.js"> </script>
  <link rel="import" href="./bower_components/font-roboto/roboto.html">
  <link rel="import" href="./bower_components/core-header-panel/core-header-panel.html">
  <link rel="import" href="./bower_components/core-toolbar/core-toolbar.html">
  <link rel="import" href="./bower_components/core-signals/core-signals.html">
  <link rel="import" href="./bower_components/paper-tabs/paper-tabs.html">
  <link rel="import" href="./bower_components/paper-icon-button/paper-icon-button.html">
  <link rel="import" href="stock-list.html">
  <link rel="import" href="stock-card.html">
  <link rel="import" href="stock-card-earnings.html">
  <link rel="import" href="stock-service.html">

  <script src="//code.highcharts.com/stock/highstock.js"></script>
  <script type="text/javascript" src="js/purl.js"></script>
  <script type="text/javascript" src="js/InteractiveChartApi.js"></script>

  <link rel="stylesheet" type="text/css" href="style.css">
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>

</head>

<body unresolved>

  <core-header-panel>

    <core-toolbar>
    <paper-icon-button id="navBtn" icon="menu" role="button" aria-label="menu"></paper-icon-button>
    <h1 flex>STCK.CO</h1>
    <p id="profileName">Andrew</p>
    <img id="profilePic" src="https://scontent-sjc.xx.fbcdn.net/hphotos-xfp1/t31.0-8/s960x960/10339532_10152851828186312_4068471070026590924_o.jpg"/>

    </core-toolbar>

 <div class="nav">
         <h2>Portfolio</h2>
          <stock-list show="all"></stock-list>
 </div>
 <div class="main">

  <stock-card symbol="GOOG" price="$500.00" change="+10%">
    <div class="graph" id="chartContainer" style="height: 400px; min-width: 310px"></div>
  </stock-card>
  <stock-card-earnings stockName="Google" lastEarnings="Jul 2" nextEarnings="Aug 2"></stock-card-earnings>
 </div>
 
  </core-header-panel>

  <script>
  var tabs = document.querySelector('paper-tabs');
  var list = document.querySelector('stock-list');
  var navbtn = document.querySelector('paper-icon-button');

  navbtn.addEventListener('click', function() {
    if ($(".nav").css("opacity") == 1) {
      $(".nav").fadeTo("fast", 0, function() {
        $(".main").animate({ 'marginLeft': '0px'}, 1000);
      });
    } else {
      $(".main").animate({ 'marginLeft': '300px'}, 1000, function() {
        $(".nav").fadeTo("fast", 1);
      });
    }
  });

    currentUser = 0;
    users = [{name:"Andrew", img:"https://scontent-sjc.xx.fbcdn.net/hphotos-xfp1/t31.0-8/s960x960/10339532_10152851828186312_4068471070026590924_o.jpg"}, {name: "Anthony", img: "https://scontent-sjc.xx.fbcdn.net/hphotos-xpa1/t31.0-8/s960x960/10694261_10153295846378319_159032172210091895_o.jpg"}, {name: "Erica", img:"https://media.licdn.com/mpr/mpr/shrinknp_400_400/p/3/000/230/2af/07b429b.jpg"}];
    $("#profilePic").on("click", function() {
      currentUser = (currentUser + 1) % 3;
      $("#profileName").text(users[currentUser].name);
      $("#profilePic").attr("src", users[currentUser].img);
    });
    //Rest of this stuff will be removed later
    $(document).ready(function() {
      var sym = 'AAPL';
      var dur = 3650;
      
      new Markit.InteractiveChartApi(sym, dur);

    });
   calcGrowth = function(){
      //console.log($(".highcharts-input-group").find($("tspan")).length);
      var firstD = new Date($(".highcharts-input-group").find($("tspan"))[0].textContent);
      var firstDate = Date.UTC(firstD.getFullYear(), firstD.getMonth(), firstD.getDate());

      var lastD = new Date($(".highcharts-input-group").find($("tspan"))[1].textContent);
      var lastDate = Date.UTC(lastD.getFullYear(), lastD.getMonth(), lastD.getDate());

      var lastPrice;
      var firstPrice;
      var found = false;
      for (var i = stockData.length - 1; i > 0; i--) {
        if (stockData[i][0] <= lastDate && !found) {
          lastPrice = stockData[i][1];
          found = true;
        }
        if (stockData[i][0] <= firstDate) {
          firstPrice = stockData[i][1];
          break;
        }
      }
      $(".growth").text(Math.round(1000 * (lastPrice - firstPrice)/firstPrice)/10 + "%");
    };

    addGrowthListener = function() {
      $(".highcharts-series").change(function() {
        console.log("changed");
      });
    };

  </script>

</body>

</html>
